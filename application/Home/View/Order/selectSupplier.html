<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>新建订单-细格订单管理系统</title>
    <meta name="description" content="这是一个 index 页面">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="icon" type="image/png" href="__PUBLIC__/i/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="__PUBLIC__/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="stylesheet" href="__PUBLIC__/css/amazeui.min.css" />
    <link rel="stylesheet" href="__PUBLIC__/css/admin.css">
    <link rel="stylesheet" href="__PUBLIC__/css/app.css">
    <style>
    </style>
</head>

<body data-type="generalComponents">
    <div class="tpl-portlet-components">
        <div class="portlet-title">
            <div class="caption font-green bold">供应商列表</div>
        </div>
        <div class="tpl-block">
            <div class="am-g">
                <input type="hidden" value="{$get['product_type_id']}" id="get_product_type_id" />
                <input type="hidden" value="{$get['product_name_id']}" id="get_product_name_id" />
                <input type="hidden" value="{$get['product_model_id']}" id="get_product_model_id" />
                <input type="hidden" value="{$get['product_spec_str']}" id="get_product_spec_str" />

                <input type="hidden" value="{$conditionType}" id="condition_type" />
                <div class="am-u-sm-12 am-u-md-1">
                    <!-- <label for="contact-department" class="am-u-sm-1 am-form-label">排序：</label> -->
                    <span>排序：</span>
                </div>
                <div class="am-u-sm-12 am-u-md-11">
                    <div class="am-btn-toolbar"> 
                        <div class="am-btn-group am-btn-group-xs">
                            <button type="button" onclick="conditionSelect('nosc')" id="condition_nosc" class="am-btn am-btn-default" style="margin-right:15px;">默认排序</button>

                            <button type="button" onclick="conditionSelect('asc')" id="condition_asc" class="am-btn am-btn-default" style="margin-right:15px;" >价格<span class="am-icon-arrow-up"></span> </button>

                            <button type="button" onclick="conditionSelect('desc')" id="condition_desc" class="am-btn am-btn-default" style="margin-right:15px;">价格<span class="am-icon-arrow-down"></span> </button>

                        </div>
                    </div>
                </div>
            </div>
            
        </div>


        <div class="tpl-block ">
            <div class="am-g tpl-amazeui-form">
                <div class="am-u-sm-12 am-u-md-9">
                    <form class="am-form am-form-horizontal">
                        <div class="am-form-group">

                            <div class="am-u-sm-7">
                                <div class="goods-title">供应商</div>
                            </div>
                            <div class="am-u-sm-4">
                                <div class="goods-title">成本单价</div>
                            </div>

                            <!-- <div>
                                <if condition="$selectSupplierInfo != '' ">
                                    <foreach name="selectSupplierInfo" item="v" key="k">
                                        <div class="am-u-sm-7"  style="margin-top:20px;">
                                            <div class="goods-name">
                                                <ul class="goods-name-detail">
                                                    <li class="xg-product-btn" id="produce_supplier_{$v.supplier_id}" value="{$v.supplier_id}" onclick="selectSupplier({$v.supplier_id})">{$v.supplier_name}</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="am-u-sm-4"  style="margin-top:20px;">
                                            <if condition="$v['price'] != '' ">
                                                <div class="goods-title" id="supplier_price_{$v.supplier_id}">
                                                    <span style="font-size:18px;"> {$v.price}元</span> 
                                                </div>
                                            <else/>
                                                <div class="goods-title">
                                                    <span  style="font-size:18px;"> 暂无</span> 
                                                </div>
                                            </if>
                                        </div>
                                    </foreach>
                                <else/>
                                    <div class="am-u-sm-7"  style="margin-top:20px;">
                                        <div class="goods-name">
                                            <ul class="goods-name-detail">
                                                <li class='select-box'><a href='javascript:;'>暂无</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="am-u-sm-4" style="margin-top:20px;">
                                        <div class="goods-title">暂无</div>
                                    </div>
                                </if>
                            </div> -->

                        </div>

                        <if condition="$selectSupplierInfo != '' ">
                            <foreach name="selectSupplierInfo" item="v" key="k">

                                <div class="am-form-group"  id="produce_supplier_{$v.supplier_id}">
                                    <div>
                                        <div class="am-u-sm-7">
                                            <div class="goods-name">
                                                <ul class="goods-name-detail">
                                                    <if condition="$v['supplier_name'] != null ">
                                                        <li class="xg-product-btn" value="{$v.supplier_id}" onclick="selectSupplier({$v.supplier_id})">{$v.supplier_name}</li>
                                                    <else/>
                                                        <li class="xg-product-btn" value="">暂无</li>
                                                    </if>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="am-u-sm-4">
                                            <if condition="$v['price'] != null ">
                                                <div class="goods-title" id="supplier_price_{$v.supplier_id}">
                                                    <span style="font-size:18px;"> {$v.price}元</span> 
                                                </div>
                                            <else/>
                                                <div class="goods-title">
                                                    <span  style="font-size:18px;"> 暂无</span> 
                                                </div>
                                            </if>
                                        </div>
                                            
                                    </div>

                                    <input type="hidden" value="{$v.supplier_id}" id="supplier_id_{$v.supplier_id}" />
                                    <input type="hidden" value="{$v.supplier_name}" id="supplier_name_{$v.supplier_id}" />
                                    <input type="hidden" value="{$v.price}" id="supplier_prices_{$v.supplier_id}" />
                                </div>

                            </foreach>
                        <else/>
                            <div class="am-form-group">
                                <div class="am-u-sm-7">
                                    <div class="goods-title">暂无</div>
                                </div>
                                <div class="am-u-sm-4">
                                    <div class="goods-title">暂无</div>
                                </div>
                            </div>
                            <!-- <div class="am-u-sm-7"  style="margin-top:20px;">
                                <div class="goods-name">
                                    <ul class="goods-name-detail">
                                        <li class='select-box'><a href='javascript:;'>暂无</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="am-u-sm-4" style="margin-top:20px;">
                                <div class="goods-title">暂无</div>
                            </div> -->
                        </if>

                        <input type="hidden" value="" id="hidden_supplier_id" />
                        <input type="hidden" value="" id="hidden_supplier_name" />
                        <input type="hidden" value="" id="hidden_supplier_price" />


                        <div class="am-form-group">
                            <div class="am-u-sm-10 am-u-sm-push-2">
                                <button type="button" id="transmit" class="am-btn am-btn-primary">确定</button>
                            </div>
                        </div>
                        
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="__PUBLIC__/js/jquery.min.js"></script>
    <script src="__PUBLIC__/js/amazeui.min.js"></script>
    <script src="__PUBLIC__/js/app.js"></script>
    <script src="__PUBLIC__/js/plus.js"></script>
    <script src="__PUBLIC__/js/layer.js"></script>
    
    <script type="text/javascript">
    

        $(document).ready(function () {
            var condition_type = $("#condition_type").val();
            
            $("#condition_"+condition_type).addClass("am-btn-danger").siblings('button').removeClass("am-btn-danger");
        });

        function selectSupplier(supplier_id){
            // alert(supplier_id);
            $("#produce_supplier_"+supplier_id).addClass("xg-product-btn-selected").siblings('div').removeClass("xg-product-btn-selected");

            //
            var name = $("#supplier_name_"+supplier_id).val();
            var price = $("#supplier_prices_"+supplier_id).val();
            // alert(name);
            // alert(price);
            $("#hidden_supplier_id").val(supplier_id);
            $("#hidden_supplier_name").val(name);
            $("#hidden_supplier_price").val(price);
        }

        function conditionSelect(type){

            var product_type_id = $("#get_product_type_id").val();
            var product_name_id = $("#get_product_name_id").val();
            var product_model_id = $("#get_product_model_id").val();
            var product_spec_str = $("#get_product_spec_str").val();

            // location.href='__APP__/Order/selectSupplier';
            location.href='__APP__/Order/selectSupplier/type/'+type+'/product_type_id/'+product_type_id+'/product_name_id/'+product_name_id+'/product_model_id/'+product_model_id+'/product_spec_str/'+product_spec_str;

            
            // $.ajax({
            // url:'__APP__/Order/selectSupplier',
            // data:'type='+type+'&product_type_id='+product_type_id+'&product_name_id='+product_name_id+'&product_model_id='+product_model_id+'&product_spec_str='+product_spec_str,
            // type:'post',
            // dataType:'json',
            // success:function(res){
                
            // }
        // });

        }

        //给父页面传值
        $('#transmit').on('click', function(){

            var supplier_id = $("#hidden_supplier_id").val();
            var supplier_name =  $("#hidden_supplier_name").val();
            var price = $("#hidden_supplier_price").val();

            if(supplier_id == ''){
                parent.layer.alert("请选择供应商！", {icon: 5,offset: '200px',});
                exit;
            }
            if(supplier_name == ''){
                layer.alert("请选择供应商！", {icon: 5,offset: '200px',});
                exit;
            }
            if(price == ''){
                var price_html = "<span style='color: #f00;'>￥ 暂无</span>";
            }else{
                var price_html = "<span style='color: #f00;'>￥ "+price+"元</span>";
            }

            var html = "<span  style='font-size:18px;''> "+supplier_name+"</span> &nbsp;&nbsp;&nbsp;&nbsp; "+price_html+"  <input type='hidden' value='"+supplier_id+"' id='select_supplier_id' /> <input type='hidden' value='"+price+"' id='product_cost_price' />";
            var product_cost_money_html = "<input type='text' name='product_cost_money' class='product_cost_money' id='product_cost_money' value='"+price+"'>";

            parent['layui-layer-iframe' + parent.layerIndexObject['A']].$('#product_supplier_select').html(' ');
            parent['layui-layer-iframe' + parent.layerIndexObject['A']].$('#product_supplier_select').html(html);
            //成本总价
            parent['layui-layer-iframe' + parent.layerIndexObject['A']].$('#product_cost_money_div').html(' ');
            parent['layui-layer-iframe' + parent.layerIndexObject['A']].$('#product_cost_money_div').html(product_cost_money_html);

            var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
            parent.layer.close(index);
        });
    </script>

</body>

</html>